/*
    main.me -- MakeMe File for the PCRE Library
 */

Me.load({
    plugins: [ 'configuration' ],

    settings: {
        me: '=0.8.4',
        prefixes: 'package-prefixes',
    },

    usage: {
        assert: 'Enable program assertions',
    },

    targets: {
        libpcre: {
            type: 'lib',
            headers: [ 'src/*.h' ],
            sources: [ 'src/*.c' ],
        },
    },

    manifest: {
        packages: {
            pak: {
                inherit:    'package-manifest',
                prefixes:   [ 'src'],
                sets:       [ 'pak' ],
            },
        },
        sets: {
            pak: [
                {   from:       'package/pcre.me',
                    to:         '${src}/pcre.me',

                }, {
                    from:       ['src/pcre.h'],
                    to:         '${src}/pcre.h',

                }, {
                    from: [
                                'src/config.h', 
                                'src/pcre_internal.h', 
                                'src/ucp.h', 
                                'src/ucpinternal.h', 
                                'src/ucptable.h', 
                                'src/*.c'
                    ], 
                    to:         '${src}/pcre.c',
                    append:     true,
                    filter:     /^#inc.*pcre.*$|#inc.*config.h.*$|#inc.*ucp.*.h.*$/mg,
                    header:     '/*\n * ${settings.title} Library Source\n */\n\n#include \"me.h\"\n#include \"pcre.h\"',
                    divider:    true,
                },
            ],
        },
    },
})
